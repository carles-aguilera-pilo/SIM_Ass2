res.cat$quanti
res.cat$test.chi2
res.cat$category
# Chunk 37
breaks <- quantile(df$city_development_index, prob = seq(0,1,0.20)); breaks
df$f.city_development_index <- cut(df$city_development_index, unique(breaks), include.lowest = TRUE)
summary(df$f.city_development_index)
breaks <- quantile(df$training_hours, probs = seq(0,1,0.2)); breaks
df$f.training_hours <- cut(df$training_hours, breaks, include.lowest = TRUE)
summary(df$f.training_hours)
# Chunk 38
#m <- glm(target~f.experience, data = df, family=binomial)
#summary(m)
df$f.experience_grouped <- fct_collapse(df$f.experience,
"Very Low" = c("<1", "1", "2"),
"Low-Medium" = c("3", "4", "5", "6"),
"Medium" = c("7", "8", "9", "10"),
"High" = c("11","12","13","14","15","16","17","18","19","20"),
"Very High" = c(">20")
)
df$f.experience_grouped <- factor(df$f.experience_grouped,
levels = c("Very Low", "Low-Medium", "Medium", "High", "Very High"), ordered = TRUE)
summary(df$f.experience_grouped)
prop.table(table(df$f.experience_grouped))
# Chunk 39
df$major_discipline_grouped <- fct_collapse(df$major_discipline,
"No STEM" = c("Arts", "Business Degree", "Humanities", "Other"))
df$major_discipline_grouped <- as.character(df$major_discipline_grouped)
df$major_discipline_grouped[ df$education_level %in% c("High School", "Primary School") ] <- "No Major"
barplot(table(df$major_discipline_grouped))
# Chunk 40
df$last_new_job <- factor(df$last_new_job, ordered = FALSE)
df$company_size <- factor(df$company_size, ordered = FALSE)
# Chunk 41
train_index <- sample(1:nrow(df),round(0.8*nrow(df),dig=0))
df_train <- df[train_index,]
df_test <- df[-train_index,]
# Chunk 42
mdl0 <- glm(target~1, data = df_train, family = binomial())
AIC(mdl0)
mdl0$deviance
# Chunk 43
mdl11 <- glm(target ~ city_development_index, family = binomial, data = df_train)
summary(mdl11)
residualPlots(mdl11)
par(mfrow=c(2,2))
marginalModelPlots(mdl11)
mdl12 <- glm(target ~ poly(city_development_index,3), family = binomial, data = df_train)
summary(mdl12)
residualPlots(mdl12)
par(mfrow=c(2,2))
marginalModelPlots(mdl12)
anova(mdl11, mdl12, test = "Chisq")
mdl13 <- glm(target ~ poly(city_development_index,4), family = binomial, data = df_train)
summary(mdl13)
residualPlots(mdl13)
par(mfrow=c(2,2))
marginalModelPlots(mdl13)
anova(mdl0, mdl13, test = "Chisq")
anova(mdl12, mdl13, test = "Chisq")
AIC(mdl12, mdl13)
# Chunk 44
mdl14 <- glm(target ~ poly(city_development_index,4) + experience, family = binomial, data = df_train)
summary(mdl14)
residualPlots(mdl14)
par(mfrow=c(2,2))
marginalModelPlots(mdl14)
anova(mdl13, mdl14, test = "Chisq")
mdl15 <- glm(target ~ poly(city_development_index,4) + poly(experience,2), family = binomial, data = df_train)
summary(mdl15)
residualPlots(mdl15)
par(mfrow=c(2,2))
marginalModelPlots(mdl15)
anova(mdl13, mdl15, test = "Chisq")
anova(mdl14, mdl15, test = "Chisq")
install.packages("ggeffects")
mdl16 <- glm(target ~ poly(city_development_index,4) + poly(experience,2) + training_hours, family = binomial, data = df_train)
summary(mdl16)
residualPlots(mdl16)
marginalModelPlots(mdl16)
anova(mdl15, mdl16, test = "Chisq")
stepnumeric <- step(mdl16)
Anova(mdl16, test = "LR")
mdl21 <- glm(target ~ poly(city_development_index,4) + poly(experience,2) + training_hours + gender + relevent_experience + enrolled_university + major_discipline + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train)
summary(mdl21)
mdl212 <- glm(target ~ poly(city_development_index,4) + poly(experience,2) + training_hours + gender + relevent_experience + enrolled_university + major_discipline_grouped + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train)
summary(mdl212)
AIC(mdl21, mdl212) # It's better the mdl212 with the grouped variable major_discipline_grouped
Anova(mdl212, test="LR")
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE, results = 'markup',message = FALSE,warning = FALSE,fig.width = 7,fig.height = 5)
# Chunk 2
set.seed(123)
if(!is.null(dev.list())) dev.off()
rm(list=ls())
# Packages
install.packages("ggeffects")
# Libraries
library(readr)
library(pROC)
library("ROCR")
library(ResourceSelection)
library(chemometrics)
library(mice)
library(car)
library(FactoMineR)
library(MASS)
library(AER)
library(effects)
library(lmtest)
library(DescTools)
library(ResourceSelection)
library(statmod)
library(cvAUC)
library(caret)
library(ModelMetrics)
library(forcats)
library(nortest)
library(corrplot)
library(naniar)
library(ggeffects)
library(ggplot2)
# Chunk 3
# Read data
df <- read.csv('aug_train.csv', header = T)
nrow(df)
summary(df)
# Chunk 4
class(df$enrollee_id)
df$enrollee_id <- as.factor(df$enrollee_id)
summary(df$enrollee_id)
sum(is.na(df$enrollee_id)); sum(df$city_development_index == "")
length(unique(df$enrollee_id))
# Chunk 5
class(df$city)
df$city <- as.factor(df$city)
sort(table(df$city))
sum(is.na(df$city)); sum(df$city_development_index == "")
length(unique(df$city))
# Chunk 6
class(df$city_development_index)
summary(df$city_development_index)
sum(is.na(df$city_development_index)); sum(df$city_development_index == "")
# Chunk 7
hist(df$city_development_index, freq = FALSE)
curve(dnorm(x, mean = mean(df$city_development_index), sd=sd(df$city_development_index)), lwd = 2, add = T, col = "red")
hist(log(df$city_development_index), freq = FALSE)
curve(dnorm(x, mean = mean(log(df$city_development_index)), sd=sd(log(df$city_development_index))), lwd = 2, add = T, col = "red")
# Chunk 8
Boxplot(df$city_development_index)
var_out <- summary(df$city_development_index)
iqr <- var_out[5] - var_out[2]
llmild <- which(df$city_development_index < var_out[2] - 1.5*iqr | df$city_development_index > var_out[5] + 1.5*iqr); length(llmild)
llsev <- which(df$city_development_index < var_out[2] - 3*iqr | df$city_development_index > var_out[5] + 3*iqr); length(llsev)
# We have 17 univariate outlaiers in the city development index
Boxplot(df$city_development_index)
abline(h = var_out[2] - 1.5*iqr, col = 'green')
abline(h = var_out[5] + 1.5*iqr, col = 'red')
abline(h = var_out[2] - 3*iqr, col = 'green')
abline(h = var_out[5] + 3*iqr, col = 'red')
df[llmild,]
# Chunk 9
class(df$gender)
df$gender[which(df$gender == "" | is.na(df$gender))] <- "Unknown"
df$gender[df$gender %in% c("Other", "Unknown")] <- "Other/Unknown"
df$gender <- as.factor(df$gender)
summary(df$gender)
prop.table(table(df$gender))
barplot(table(df$gender))
# Chunk 10
class(df$relevent_experience)
df$relevent_experience <- as.factor(df$relevent_experience)
summary(df$relevent_experience)
prop.table(table(df$relevent_experience))
barplot(table(df$relevent_experience))
sum(is.na(df$relevent_experience)); sum(df$relevent_experience == "");
# Chunk 11
class(df$education_level)
df$education_level <- as.factor(df$education_level)
summary(df$education_level)
prop.table(table(df$education_level))
barplot(table(df$education_level))
sum(is.na(df$education_level)); sum(df$education_level == "");
df$education_level[which(df$education_level == "")] <- NA
df$education_level <- droplevels(df$education_level)
# Chunk 12
class(df$enrolled_university)
df$enrolled_university <- as.factor(df$enrolled_university)
summary(df$enrolled_university)
prop.table(table(df$enrolled_university))
barplot(table(df$enrolled_university))
sum(is.na(df$enrolled_university)); sum(df$enrolled_university == "")
df$enrolled_university[which(df$enrolled_university == "")] <- NA
list <- df$education_level %in% c("Primary School") & is.na(df$enrolled_university)
sum(list)
df$enrolled_university[list] <- "no_enrollment"
df$enrolled_university <- droplevels(df$enrolled_university)
# Chunk 13
class(df$major_discipline)
df$major_discipline <- as.factor(df$major_discipline)
summary(df$major_discipline)
prop.table(table(df$major_discipline))
barplot(table(df$major_discipline))
sum(is.na(df$major_discipline)); sum(df$major_discipline == "");
df$major_discipline[which(df$major_discipline == "")] <- NA
table(df$major_discipline)
list <- df$education_level %in% c("High School", "Primary School") & is.na(df$major_discipline)
sum(list)
df$major_discipline[list] <- "No Major"
sum(is.na(df$major_discipline))
prop.table(table(df$major_discipline))
df$major_discipline <- droplevels(df$major_discipline)
# Chunk 14
class(df$experience)
x <- c("", "<1", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", ">20")
df$f.experience <- factor(df$experience, levels = x, ordered = TRUE)
summary(df$f.experience)
prop.table(table(df$f.experience))
barplot(table(df$f.experience))
sum(is.na(df$f.experience)); sum(df$f.experience == "");
df$f.experience[which(df$f.experience == "")] <- NA
df$f.experience <- droplevels(df$f.experience)
# Chunk 15
prop.table(table(df$relevent_experience, df$f.experience))
# Chunk 16
df$experience[which(df$experience==">20")] <- 25
df$experience[which(df$experience == "<1")] <- 0.05
df$experience <-  as.numeric(df$experience)
summary(df$experience)
# Chunk 17
hist(df$experience, freq = FALSE)
Boxplot(df$experience)
# Chunk 18
class(df$company_size)
x <- c("", "<10", "10/49", "50-99", "100-500", "500-999", "1000-4999", "5000-9999", "10000+")
df$company_size <- factor(df$company_size, levels = x, ordered = TRUE)
levels(df$company_size) <- c(levels(df$company_size), "Unknown")
df$company_size[df$company_size == ""] <- "Unknown"
df$company_size <- droplevels(df$company_size)
summary(df$company_size)
prop.table(table(df$company_size))
barplot(table(df$company_size))
# Chunk 19
class(df$company_type)
df$company_type <- as.factor(df$company_type)
levels(df$company_type) <- c(levels(df$company_type), "Unknown")
df$company_type[df$company_type == ""] <- "Unknown"
df$company_type <- droplevels(df$company_type)
summary(df$company_type)
prop.table(table(df$company_type))
barplot(table(df$company_type))
# Chunk 20
class(df$last_new_job)
x <- c("", "never", "1", "2", "3", "4", ">4")
df$last_new_job <- factor(df$last_new_job, levels = x, ordered = TRUE)
summary(df$last_new_job)
prop.table(table(df$last_new_job))
barplot(table(df$last_new_job))
sum(is.na(df$last_new_job)); sum(df$last_new_job == "");
df$last_new_job[which(df$last_new_job == "")] <- NA
df$last_new_job <- droplevels(df$last_new_job)
# Chunk 21
class(df$training_hours)
df$training_hours <- as.numeric(df$training_hours)
summary(df$training_hours)
sum(is.na(df$training_hours)); sum(df$training_hours == "")
# Chunk 22
hist(df$training_hours, freq = FALSE)
curve(dnorm(x, mean = mean(df$training_hours), sd=sd(df$training_hours)), lwd = 2, add = T, col = "red")
hist(log(df$training_hours), freq = FALSE)
curve(dnorm(x, mean = mean(log(df$training_hours)), sd=sd(log(df$training_hours))), lwd = 2, add = T, col = "red")
ks.test(log(df$training_hours), "pnorm", mean = mean(log(df$training_hours)), sd = sd(log(df$training_hours)))
ad.test(log(df$training_hours))
# Chunk 23
Boxplot(df$training_hours)
var_out <- summary(df$training_hours)
iqr <- var_out[5] - var_out[2]
llmild <- which(df$training_hours < var_out[2] - 1.5*iqr | df$training_hours > var_out[5] + 1.5*iqr); length(llmild)
llsev <- which(df$training_hours < var_out[2] - 3*iqr | df$training_hours > var_out[5] + 3*iqr); length(llsev)
Boxplot(df$training_hours)
abline(h = var_out[2] - 1.5*iqr, col = 'green')
abline(h = var_out[5] + 1.5*iqr, col = 'green')
abline(h = var_out[2] - 3*iqr, col = 'red')
abline(h = var_out[5] + 3*iqr, col = 'red')
df[llmild,]
# Chunk 24
class(df$target)
df$target <- as.factor(df$target)
summary(df$target)
prop.table(table(df$target))
barplot(table(df$target))
sum(is.na(df$target)); sum(df$target == "");
# Chunk 25
df_aux <- df
df_aux$gender[which(df_aux$gender == "Other/Unknown")] <- NA
df_aux$company_size[which(df_aux$company_size == "Unknown")] <- NA
df_aux$company_type[which(df_aux$company_type == "Unknown")] <- NA
gg_miss_var(df_aux[c(4,6:12)])
gg_miss_upset(df_aux[c(4,6:12)])
# Chunk 26
res.cat <- catdes(df[c(3:15),], 11)
res.cat$category
res.cat$quanti
# Chunk 27
df[c(3:15),]
res.cat <- catdes(df[c(3:15),], 10)
res.cat$category
res.cat$quanti
# Chunk 28
res.mice <- mice(df[,c(3:15)])
df_imp <- complete(res.mice)
# Chunk 29
prop.table(table(df$enrolled_university))
prop.table(table(df_imp$enrolled_university))
prop.table(table(df$education_level))
prop.table(table(df_imp$education_level))
prop.table(table(df$major_discipline))
prop.table(table(df_imp$major_discipline))
prop.table(table(df$last_new_job))
prop.table(table(df_imp$last_new_job))
df$enrolled_university <- df_imp$enrolled_university
df$education_level <- df_imp$education_level
df$major_discipline <- df_imp$major_discipline
df$last_new_job <- df_imp$last_new_job
# Chunk 30
par(mfrow=c(1,2))
hist(df$experience)
hist(df_imp$experience)
quantile(df$experience, na.rm = TRUE)
quantile(df_imp$experience)
df_imp$f.experience <- ifelse(df_imp$experience < 1, "<1", ifelse(df_imp$experience > 20, ">20",as.character(df_imp$experience)))
df_imp$f.experience <- as.factor(df_imp$f.experience)
prop.table(table(df$f.experience))
prop.table(table(df_imp$f.experience))
df$experience <- df_imp$experience
df$f.experience <- df_imp$f.experience
# Chunk 31
num_vars <- c("city_development_index", "training_hours", "experience")
df_numeric <- df[, num_vars]
# Chunk 32
corr_mat <- cor(df_numeric)
corr_mat
corrplot(corr_mat, method = "color", tl.col = "black", tl.srt = 45, addCoef.col = "black")
plot(df_numeric)
# Chunk 33
res.mout <- Moutlier(df_numeric,quantile=0.95, plot = F)
plot(res.mout$md,res.mout$rd,col="cyan",pch=19)
abline(h=res.mout$cutoff,col="red",lwd=2)
abline(v=res.mout$cutoff,col="red",lwd=2)
text(res.mout$md,res.mout$rd,label=row.names(df),cex=0.5)
# Chunk 34
ll <- which( (res.mout$md>res.mout$cutoff) & (res.mout$rd>res.mout$cutoff)); length(ll)
df$isMvOutlier <- 0
df$isMvOutlier[ll] <- 1
df$isMvOutlier <- factor(df$isMvOutlier, labels = c("MvoutNo", "MvoutYes"))
# Chunk 35
res.cat <- catdes(df[,c(3:16)], 14)
res.cat$test.chi2
res.cat$category
res.cat$quanti.var
res.cat$quanti
# Chunk 36
res.cat <- catdes(df[,c(3:15)], num.var = 12)
res.cat$quanti.var
res.cat$quanti
res.cat$test.chi2
res.cat$category
# Chunk 37
breaks <- quantile(df$city_development_index, prob = seq(0,1,0.20)); breaks
df$f.city_development_index <- cut(df$city_development_index, unique(breaks), include.lowest = TRUE)
summary(df$f.city_development_index)
breaks <- quantile(df$training_hours, probs = seq(0,1,0.2)); breaks
df$f.training_hours <- cut(df$training_hours, breaks, include.lowest = TRUE)
summary(df$f.training_hours)
# Chunk 38
#m <- glm(target~f.experience, data = df, family=binomial)
#summary(m)
df$f.experience_grouped <- fct_collapse(df$f.experience,
"Very Low" = c("<1", "1", "2"),
"Low-Medium" = c("3", "4", "5", "6"),
"Medium" = c("7", "8", "9", "10"),
"High" = c("11","12","13","14","15","16","17","18","19","20"),
"Very High" = c(">20")
)
df$f.experience_grouped <- factor(df$f.experience_grouped,
levels = c("Very Low", "Low-Medium", "Medium", "High", "Very High"), ordered = TRUE)
summary(df$f.experience_grouped)
prop.table(table(df$f.experience_grouped))
# Chunk 39
df$major_discipline_grouped <- fct_collapse(df$major_discipline,
"No STEM" = c("Arts", "Business Degree", "Humanities", "Other"))
df$major_discipline_grouped <- as.character(df$major_discipline_grouped)
df$major_discipline_grouped[ df$education_level %in% c("High School", "Primary School") ] <- "No Major"
barplot(table(df$major_discipline_grouped))
# Chunk 40
df$last_new_job <- factor(df$last_new_job, ordered = FALSE)
df$company_size <- factor(df$company_size, ordered = FALSE)
# Chunk 41
train_index <- sample(1:nrow(df),round(0.8*nrow(df),dig=0))
df_train <- df[train_index,]
df_test <- df[-train_index,]
# Chunk 42
mdl0 <- glm(target~1, data = df_train, family = binomial())
AIC(mdl0)
mdl0$deviance
# Chunk 43
mdl11 <- glm(target ~ city_development_index, family = binomial, data = df_train)
summary(mdl11)
residualPlots(mdl11)
par(mfrow=c(2,2))
marginalModelPlots(mdl11)
mdl12 <- glm(target ~ poly(city_development_index,3), family = binomial, data = df_train)
summary(mdl12)
residualPlots(mdl12)
par(mfrow=c(2,2))
marginalModelPlots(mdl12)
anova(mdl11, mdl12, test = "Chisq")
mdl13 <- glm(target ~ poly(city_development_index,4), family = binomial, data = df_train)
summary(mdl13)
residualPlots(mdl13)
par(mfrow=c(2,2))
marginalModelPlots(mdl13)
anova(mdl0, mdl13, test = "Chisq")
anova(mdl12, mdl13, test = "Chisq")
AIC(mdl12, mdl13)
# Chunk 44
mdl14 <- glm(target ~ poly(city_development_index,4) + experience, family = binomial, data = df_train)
summary(mdl14)
residualPlots(mdl14)
par(mfrow=c(2,2))
marginalModelPlots(mdl14)
anova(mdl13, mdl14, test = "Chisq")
mdl15 <- glm(target ~ poly(city_development_index,4) + poly(experience,2), family = binomial, data = df_train)
summary(mdl15)
residualPlots(mdl15)
par(mfrow=c(2,2))
marginalModelPlots(mdl15)
anova(mdl13, mdl15, test = "Chisq")
anova(mdl14, mdl15, test = "Chisq")
install.packages("ggeffects")
mdl16 <- glm(target ~ poly(city_development_index,4) + poly(experience,2) + training_hours, family = binomial, data = df_train)
summary(mdl16)
residualPlots(mdl16)
marginalModelPlots(mdl16)
anova(mdl15, mdl16, test = "Chisq")
stepnumeric <- step(mdl16)
Anova(mdl16, test = "LR")
mdl21 <- glm(target ~ poly(city_development_index,4) + poly(experience,2) + training_hours + gender + relevent_experience + enrolled_university + major_discipline + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train)
summary(mdl21)
mdl212 <- glm(target ~ poly(city_development_index,4) + poly(experience,2) + training_hours + gender + relevent_experience + enrolled_university + major_discipline_grouped + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train)
summary(mdl212)
AIC(mdl21, mdl212) # It's better the mdl212 with the grouped variable major_discipline_grouped
Anova(mdl212, test="LR")
mdl22 <- glm(target ~ poly(city_development_index,4) + poly(experience,2) + relevent_experience + enrolled_university + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train)
summary(mdl22)
summary(mdl212)
summary(mdl16)
summary(mdl21)
mdl212 <- glm(target ~ poly(city_development_index,4) + poly(experience,2) + training_hours + gender + relevent_experience + enrolled_university + major_discipline_grouped + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train)
summary(mdl212)
mdl22 <- glm(target ~ poly(city_development_index,4) + poly(experience,2) + training_hours + relevent_experience + enrolled_university + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train)
summary(mdl22)
mdl22 <- glm(target ~ poly(city_development_index,4) + poly(experience,2) + relevent_experience + enrolled_university + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train)
summary(mdl22)
vif(mdl22)
mdl31 <- glm(target ~ f.city_development_index + f.experience + f.training_hours + relevent_experience + enrolled_university + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train) # all as factor
mdl32 <- glm(target ~ f.city_development_index + f.experience_grouped + f.training_hours + relevent_experience + enrolled_university + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train) # all as factor with experience grouped
mdl33 <- glm(target ~ f.city_development_index + poly(experience,2) + training_hours + relevent_experience + enrolled_university + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train) # city as factor the rest as numeric
mdl34 <- glm(target ~ poly(city_development_index,4) + f.experience + training_hours + relevent_experience + enrolled_university + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train) # experience as factor the rest as numeric
mdl35 <- glm(target ~ poly(city_development_index,4) + f.experience_grouped + training_hours + relevent_experience + enrolled_university + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train) # experience as grouped factor the rest as numeric
mdl36 <- glm(target ~ poly(city_development_index,4) + poly(experience,2) + f.training_hours + relevent_experience + enrolled_university + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train) # training hours as factor the rest as numeric
mdl37 <- glm(target ~ poly(city_development_index,4)+ f.experience + f.training_hours + relevent_experience + enrolled_university + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train) # training hours and experience as factor the rest as numeric
mdl38 <- glm(target ~ poly(city_development_index,4) + f.experience_grouped + f.training_hours + relevent_experience + enrolled_university + education_level + company_size + company_type + last_new_job, family = binomial, data = df_train) # training hours and experience grouped as factor the rest as numeric
AIC(mdl22, mdl31, mdl32, mdl33, mdl34, mdl35, mdl36, mdl37, mdl38)
vif(mdl22) # no multicollinearity present in the model
mdl41 <- glm(target ~ (poly(city_development_index, 4) + poly(experience, 2))*(relevent_experience + enrolled_university + education_level + company_size + company_type + last_new_job), family = binomial, data = df_train)
summary(mdl41)
residualPlots(mdl41)
marginalModelPlots(mdl41)
stepinteractionsAIC <- step(mdl41)
stepinteractionsBIC <- step(mdl41, k=log(nrow(df_train)))
AIC(stepinteractionsAIC, stepinteractionsBIC, mdl41)
anova(stepinteractionsAIC, stepinteractionsBIC, test = "Chisq")
anova(stepinteractionsAIC, mdl22, test = "Chisq")
mdl_f <- glm(target ~ poly(city_development_index, 4) * (relevent_experience + last_new_job + education_level + company_size) + poly(experience, 2) * (relevent_experience + last_new_job) + enrolled_university + company_type, family=binomial(), data=df_train)
summary(mdl_f)
vif(mdl_f)
residualPlots(mdl_f)
marginalModelPlots(mdl_f)
par(mfrow=c(1,1))
rstudent_influential <- rstudent(mdl_f)
Boxplot(rstudent_influential)
abline(h = 3, col = 'red');abline(h = -3, col = 'red')
idx_rstudent <- which(rstudent_influential > 3 | rstudent_influential < -3); length(idx_rstudent);
hat_influential <- hatvalues(mdl_f)
Boxplot(hat_influential)
idx_hat <- which(hat_influential > 0.3); length(idx_hat);
cook_influential <- cooks.distance(mdl_f)
Boxplot(cook_influential)
idx_cooks <- which(cook_influential > 0.03); length(idx_cooks);
df_train_clean <- df_train[-c(idx_cooks, idx_rstudent),]
mdl_f <- glm(target ~ poly(city_development_index, 4) * (relevent_experience + last_new_job + education_level + company_size) + poly(experience, 2) * (relevent_experience + last_new_job) + enrolled_university + company_type, family=binomial(), data=df_train_clean)
par(mfrow=c(1,1))
rstudent_influential <- rstudent(mdl_f)
Boxplot(rstudent_influential)
abline(h = 3, col = 'red');abline(h = -3, col = 'red')
idx_rstudent <- which(rstudent_influential > 3 | rstudent_influential < -3); length(idx_rstudent);
hat_influential <- hatvalues(mdl_f)
Boxplot(hat_influential)
cook_influential <- cooks.distance(mdl_f)
Boxplot(cook_influential)
idx_cooks <- which(cook_influential > 0.04); length(idx_cooks);
